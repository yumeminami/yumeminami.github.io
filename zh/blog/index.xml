<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Blogs on YUMEMINAMI</title><link>https://yumeminami.github.io/zh/blog/</link><description>Recent content in Blogs on YUMEMINAMI</description><generator>Hugo -- gohugo.io</generator><copyright>2023 Wingmun Fung All rights reserved</copyright><lastBuildDate>Thu, 10 Aug 2023 09:37:27 +0800</lastBuildDate><atom:link href="https://yumeminami.github.io/zh/blog/index.xml" rel="self" type="application/rss+xml"/><item><title>WSL2找不到Docker容器的日志問題</title><link>https://yumeminami.github.io/zh/blog/zh/could-not-find-docker-log-in-wsl2/</link><pubDate>Thu, 10 Aug 2023 09:37:27 +0800</pubDate><guid>https://yumeminami.github.io/zh/blog/zh/could-not-find-docker-log-in-wsl2/</guid><description>&lt;h3 id="背景">背景：&lt;/h3>
&lt;p>使用ELK收集Docker容器的日志數據，在filebeat配置中指定Container的日志路徑后，在Kibana看板卻看不到任何日志消息&lt;/p>
&lt;h3 id="排查過程">排查過程：&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>使用docker logs命令查看容器日志，發現日志正常輸出:&lt;/p>
&lt;pre tabindex="0">&lt;code>ubuntu@DESKTOP-HH3PJAQ:~$ docker logs -f app
INFO:Connecting to database...
INFO:Connected to database!
INFO:topicmanager initialized
INFO:Connecting to redis...
INFO:Connected to redis!
INFO:
________ _____ ______ ________ ______ _____
___ __ \_____ __ /________________ / ___ __ \________ /_________ /_
__ /_/ / __ `/ __/_ ___/ __ \_ / __ /_/ / __ \_ __ \ __ \ __/
_ ____// /_/ // /_ _ / / /_/ / / _ _, _// /_/ / /_/ / /_/ / /_
/_/ \__,_/ \__/ /_/ \____//_/ /_/ |_| \____//_.___/\____/\__/
________ _____
__ ___/____ __________ /____________ ___
_____ \__ / / /_ ___/ __/ _ \_ __ `__ \
____/ /_ /_/ /_(__ )/ /_ / __/ / / / / /
/____/ _\__, / /____/ \__/ \___//_/ /_/ /_/
/____/
INFO:Server Start...
INFO:Initializing ROS node...
INFO:ROS node initialized.
DEBUG:Creating node: zj_robot_subscriber
DEBUG:xmlrpc_port: 45159
DEBUG:tcpros_port: 45160
DEBUG:Using selector: EpollSelector
INFO: Started server process [1]
INFO: Waiting for application startup.
INFO: Application startup complete.
INFO: Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
DEBUG:tm._add: /zj_robot/robot_real_time_info, common/robot_real_time_info, sub
DEBUG:master.registerSubscriber(/zj_robot_subscriber, /zj_robot/robot_real_time_info, common/robot_real_time_info, http://192.168.2.43:45159/)
DEBUG:tm._add: /zj_robot/sensor_data, common/sensor_data, sub
DEBUG:master.registerSubscriber(/zj_robot_subscriber, /zj_robot/sensor_data, common/sensor_data, http://192.168.2.43:45159/)
DEBUG:master.registerService(/zj_robot_subscriber, /zj_robot/patrol_picture, rosrpc://192.168.2.43:45160, http://192.168.2.43:45159/)
DEBUG:requestTopic(&amp;#39;/rosout&amp;#39;, &amp;#39;/rosout&amp;#39;, [[&amp;#39;TCPROS&amp;#39;]])
DEBUG:requestTopic[/rosout]: choosing protocol TCPROS
DEBUG:requestTopic(&amp;#39;/rosout&amp;#39;, &amp;#39;/rosout&amp;#39;, [[&amp;#39;TCPROS&amp;#39;]]) returns (1, &amp;#39;ready on 192.168.2.43:45160&amp;#39;, [&amp;#39;TCPROS&amp;#39;, &amp;#39;192.168.2.43&amp;#39;, 45160])
DEBUG:[/rosout]: writing header
INFO:topic[/rosout] adding connection to [/rosout], count 0
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>使用docker inspect命令查看容器的日志存儲路徑:&lt;/p>
&lt;pre tabindex="0">&lt;code>ubuntu@DESKTOP-HH3PJAQ:~$ docker inspect --format=&amp;#39;{{.LogPath}}&amp;#39; app
/var/lib/docker/containers/e2672e782614ed962050ac43c0691d1abe4bd753911b7429127b78216cc8e252/e2672e782614ed962050ac43c0691d1abe4bd753911b7429127b78216cc8e252-json.log
ubuntu@DESKTOP-HH3PJAQ:~$ cat /var/lib/docker/containers/e2672e782614ed962050ac43c0691d1abe4bd753911b7429127b78216cc8e252/e2672e782614ed962050ac43c0691d1abe4bd753911b7429127b78216cc8e252-json.log
cat: /var/lib/docker/containers/e2672e782614ed962050ac43c0691d1abe4bd753911b7429127b78216cc8e252/e2672e782614ed962050ac43c0691d1abe4bd753911b7429127b78216cc8e252-json.log: No such file or directory
&lt;/code>&lt;/pre>&lt;p>明明存在日志的文件路徑，但是卻現日志文件是空的&lt;/p>
&lt;/li>
&lt;li>
&lt;p>搜索微軟官方關於WSL2文檔：&lt;/p>
&lt;p>原因如下：&lt;/p>
&lt;p>&lt;img src="https://github.com/yumeminami/yumeminami.github.io/blob/master/content/static/images/77fc7dd5dda9c12f60e589b82d5d7e3.png?raw=true" alt="image">&lt;/p>
&lt;p>於是就去文件管理器中查看WSL2的文件路徑，發現原來Docker的日志文件路徑是在Windows的文件系統中，而不是在WSL2的文件系統中&lt;/p>
&lt;p>&lt;img src="https://github.com/yumeminami/yumeminami.github.io/blob/f226ae091683e6b691ce84f462e84dc4ec078836/content/static/images/87bd14d7d50457d610fa920757d408a.png?raw=true" alt="image">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>在WSL2下嘗試訪問此路徑&lt;/p>
&lt;pre tabindex="0">&lt;code>ubuntu@DESKTOP-HH3PJAQ:~$ cd \\wsl.localhost\docker-desktop-data\data\docker\containers
bash: cd: \wsl.localhostdocker-desktop-datadatadockercontainers: No such file or directory
&lt;/code>&lt;/pre>&lt;p>無法訪問，後來的經過瞭解，需要先挂載此路徑，才能訪問&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="如何解決">如何解決&lt;/h3>
&lt;p>步驟1:
打開Windows的Powershell，輸入以下命令：
&lt;code>net use h:\\wsl$\docker-desktop-data&lt;/code>
其中，请将 h: 替换为您的计算机上不存在的驱动器号。&lt;/p>
&lt;p>步驟2:
打開WSL2的終端，輸入以下命令：&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo mkdir /mnt/docker
sudo mount -t drvfs h: /mnt/docker
&lt;/code>&lt;/pre>&lt;p>步驟3:&lt;/p>
&lt;p>進入挂載好的路徑下查看docker的data是否存在&lt;/p>
&lt;pre tabindex="0">&lt;code>ubuntu@DESKTOP-HH3PJAQ:/$ cd mnt/docker/data/docker/containers/
ubuntu@DESKTOP-HH3PJAQ:/mnt/docker/data/docker/containers$ ls
035a0b71b2d1af780ee4d2f842312a7bdd567c92e9d869e34c07247a25264738 7233933f73122fd8550c2c77a969db8510cd36f16b86c8b5daf30b80526841a6 d16dc3c4c2c40d39093394a90f582c721189f78e436c2bde5a2bd026b64cb2d9
0de4fe9b26a150a69c78d862250e83e329cc8468b83091bc6cd7c4fb7b709934 794f43911f4bdabb8664c061bd330a7fc16901d859e2254cc88f0364278dc93a e2672e782614ed962050ac43c0691d1abe4bd753911b7429127b78216cc8e252
3041de6e974c461b02cb9f23a2e242543f895a4b6a0156b81a365df74fd09012 acb6870794061a86343bd1f4f0c5cc08007ed1f94f6adad685cbfbfb102d8947
6a7ccd0ff090a547498096c388f1b796340a2cd3b32b2fc3feb6af79d329bbee cf49abae77f0240a19f843baf6e807d16a8ba3fd3aa404c679274cb95c02cafb
&lt;/code>&lt;/pre>&lt;p>至此問題已經解決，只需在docker-compose的filebeat配置文件中做好日志的映射即可。
遺留問題：使用inspect命令得到的路徑到底從何而來呢？&lt;/p>
&lt;h3 id="參考文檔">參考文檔&lt;/h3>
&lt;p>&lt;a href="https://learn.microsoft.com/zh-tw/windows/wsl/tutorials/wsl-containers">在 WSL 2 上開始使用 Docker 遠端容器&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/microsoft/WSL/discussions/4176">WSL2 where is docker volume location? &lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/microsoft/WSL/discussions/4176#discussioncomment-831817">如何挂載Docker路徑到WSL2中&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://stackoverflow.com/questions/56518032/windows-10-and-docker-container-logs-docker-logging-driver">where can I find Docker in windows 10 ?&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://reachmnadeem.wordpress.com/2021/02/14/windows-10-location-for-docker-volumes-and-container-logs/">WINDOWS 10 LOCATION FOR DOCKER VOLUMES AND CONTAINER LOGS&lt;/a>&lt;/p></description></item><item><title>日本語テスト</title><link>https://yumeminami.github.io/zh/blog/zh/%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%86%E3%82%B9%E3%83%88/</link><pubDate>Tue, 24 Dec 2013 23:33:26 +0000</pubDate><guid>https://yumeminami.github.io/zh/blog/zh/%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%86%E3%82%B9%E3%83%88/</guid><description>&lt;p>This is a Japanese test post.&lt;/p>
&lt;p>私は昨日ついにその助力家というのの上よりするたなけれ。&lt;/p>
&lt;p>最も今をお話団はちょうどこの前後なかろでくらいに困りがいるたをは帰着考えたなかって、そうにもするでうたらない。&lt;/p>
&lt;p>がたを知っないはずも同時に九月をいよいよたありた。&lt;/p>
&lt;p>もっと槙さんにぼんやり金少し説明にえた自分大した人私か影響にというお関係たうませないが、この次第も私か兄具合に使うて、槙さんののに当人のあなたにさぞご意味と行くて私個人が小尊敬を聴いように同時に同反抗に集っだうて、いよいよまず相当へあっうからいだ事をしでなけれ。&lt;/p>
&lt;blockquote>
&lt;p>それでそれでもご時日をしはずはたったいやと突き抜けるますて、その元がは行ったてという獄を尽すていけですた。&lt;/p>
&lt;/blockquote>
&lt;p>この中道具の日その学校はあなたごろがすまなりかとネルソンさんの考えるですん、辺の事実ないというご盲従ありたですと、爺さんのためが薬缶が結果までの箸の当時してならて、多少の十月にためからそういう上からとにかくしましないと触れべきものたで、ないうですと多少お人達したのでたた。&lt;/p>
&lt;p>&lt;em>From &lt;a href="http://lipsum.sugutsukaeru.jp/index.cgi">すぐ使えるダミーテキスト - 日本語 Lorem ipsum&lt;/a>&lt;/em>&lt;/p></description></item><item><title>中文測試</title><link>https://yumeminami.github.io/zh/blog/zh/%E4%B8%AD%E6%96%87%E6%B8%AC%E8%A9%A6/</link><pubDate>Tue, 24 Dec 2013 23:31:30 +0000</pubDate><guid>https://yumeminami.github.io/zh/blog/zh/%E4%B8%AD%E6%96%87%E6%B8%AC%E8%A9%A6/</guid><description>&lt;p>This is a Chinese test post.&lt;/p>
&lt;p>善我王上魚、產生資西員合兒臉趣論。畫衣生這著爸毛親可時，安程幾？合學作。觀經而作建。都非子作這！法如言子你關！手師也。&lt;/p>
&lt;p>以也座論頭室業放。要車時地變此親不老高小是統習直麼調未，行年香一？&lt;/p>
&lt;p>就竟在，是我童示讓利分和異種百路關母信過明驗有個歷洋中前合著區亮風值新底車有正結，進快保的行戰從：弟除文辦條國備當來際年每小腳識世可的的外的廣下歌洲保輪市果底天影；全氣具些回童但倒影發狀在示，數上學大法很，如要我……月品大供這起服滿老？應學傳者國：山式排只不之然清同關；細車是！停屋常間又，資畫領生，相們制在？公別的人寫教資夠。資再我我！只臉夫藝量不路政吃息緊回力之；兒足灣電空時局我怎初安。意今一子區首者微陸現際安除發連由子由而走學體區園我車當會，經時取頭，嚴了新科同？很夫營動通打，出和導一樂，查旅他。坐是收外子發物北看蘭戰坐車身做可來。道就學務。&lt;/p>
&lt;p>國新故。&lt;/p>
&lt;blockquote>
&lt;p>工步他始能詩的，裝進分星海演意學值例道……於財型目古香亮自和這乎？化經溫詩。只賽嚴大一主價世哥受的沒有中年即病行金拉麼河。主小路了種就小為廣不？&lt;/p>
&lt;/blockquote>
&lt;p>&lt;em>From &lt;a href="http://www.richyli.com/tool/loremipsum/">亂數假文產生器 - Chinese Lorem Ipsum&lt;/a>&lt;/em>&lt;/p></description></item></channel></rss>